<div class='post'>
  <div><%= post.author.name %> <%= post.author.last_name %></div>
  <div><%= post.content %></div>
  <div>Likes: <%= post.likes.size %></div>
  <% if Like.where(user_id: current_user.id, likeable_type: 'Post', likeable_id: post.id).exists? %>
    <%= link_to 'Unlike', like_path(post.likes.find_by(user_id: current_user.id).id), data: { turbo_method: :delete } %>
  <% else %>
    <%= form_with model: Like.new(), url:likes_path do |form| %>
      <%= form.hidden_field :likeable_type, value: 'Post' %>
      <%= form.hidden_field :likeable_id, value: post.id %>
      <%= form.hidden_field :user_id, value: current_user.id %>
      <%= form.submit 'Like' %>
    <% end %>
  <% end %>

  <% if post.author == current_user %>
    <%= link_to 'Delete post', post_path(post.id), data: { turbo_method: 'delete' } %>
  <% end %>

  <%= render post.comments %>

  <%= form_with model: Comment.new(), url: comments_path do |form| %>
    <%= form.text_area :content, placeholder: 'Comment here' %>
    <%= form.hidden_field :post_id, value: post.id %>
    <%= form.hidden_field :user_id, value: current_user.id %>
    <%= form.submit 'Comment' %>
  <% end %>
</div>